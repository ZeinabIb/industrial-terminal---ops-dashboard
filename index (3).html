<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>StockOS ‚Äì Inventory Management</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}

:root {
  /* Apple dark system palette */
  --bg:        #000000;
  --surface:   #111111;
  --surface2:  #1c1c1e;
  --surface3:  #2c2c2e;
  --border:    rgba(255,255,255,0.07);
  --border2:   rgba(255,255,255,0.12);
  --text:      #f5f5f7;
  --text2:     rgba(245,245,247,0.55);
  --text3:     rgba(245,245,247,0.28);
  --cyan:      #0a84ff;
  --cyan-dim:  rgba(10,132,255,0.14);
  --green:     #30d158;
  --green-dim: rgba(48,209,88,0.13);
  --yellow:    #ff9f0a;
  --yellow-dim:rgba(255,159,10,0.13);
  --red:       #ff453a;
  --red-dim:   rgba(255,69,58,0.13);
  --blue:      #0a84ff;
  --blue-dim:  rgba(10,132,255,0.13);
  --purple:    #bf5af2;
  --sans: -apple-system,'SF Pro Display','SF Pro Text','Helvetica Neue',sans-serif;
  --mono: 'SF Mono','Fira Code','Fira Mono',monospace;
}

html { font-size:16px; }
body {
  font-family: var(--sans);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
}

/* ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ */
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--surface3);border-radius:4px}

/* ‚îÄ‚îÄ AUTH ‚îÄ‚îÄ */
.auth-screen {
  min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px;
  position:relative; overflow:hidden;
  background:
    radial-gradient(ellipse 70% 50% at 20% 20%, rgba(10,132,255,0.12) 0%, transparent 65%),
    radial-gradient(ellipse 60% 60% at 80% 80%, rgba(191,90,242,0.1) 0%, transparent 65%);
}
.auth-grid-bg {
  position:fixed; inset:0; z-index:0; pointer-events:none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
}
.auth-panel {
  position:relative; z-index:1;
  width:100%; max-width:440px;
  background:rgba(28,28,30,0.8);
  border:1px solid var(--border2);
  border-radius:20px;
  box-shadow:0 32px 80px rgba(0,0,0,0.6), 0 0 0 0.5px rgba(255,255,255,0.05) inset;
  backdrop-filter:blur(40px) saturate(180%);
  -webkit-backdrop-filter:blur(40px) saturate(180%);
  animation:fadeUp .4s cubic-bezier(.34,1.2,.64,1);
}
@keyframes fadeUp{from{opacity:0;transform:translateY(18px) scale(.97)}to{opacity:1;transform:none}}

.auth-header {
  padding:26px 28px 22px;
  border-bottom:1px solid var(--border);
  display:flex; align-items:center; gap:14px;
}
.auth-logo-icon {
  width:42px; height:42px; border-radius:11px;
  background:linear-gradient(135deg,var(--cyan),var(--purple));
  display:flex; align-items:center; justify-content:center;
  flex-shrink:0; box-shadow:0 4px 16px rgba(10,132,255,0.35);
}
.auth-logo-icon::before { display:none; }
.auth-logo-icon svg { color:#fff; }
.auth-logo-name { font-size:1.3rem; font-weight:700; letter-spacing:-0.03em; color:var(--text); }
.auth-logo-name span { background:linear-gradient(135deg,var(--cyan),var(--purple)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
.auth-logo-sub { font-size:0.68rem; color:var(--text3); letter-spacing:0.06em; margin-top:2px; }
.auth-body { padding:24px 28px 28px; }
.auth-section-label {
  font-size:0.68rem; font-weight:600; letter-spacing:0.04em;
  color:var(--text3); margin-bottom:8px;
  display:flex; align-items:center; gap:8px;
}
.auth-section-label::after { content:''; flex:1; height:1px; background:var(--border); }
.auth-role-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:22px; }
.auth-role-btn {
  padding:13px 12px; border:1px solid var(--border);
  background:rgba(255,255,255,0.04); border-radius:12px;
  cursor:pointer; transition:all .15s; text-align:left;
}
.auth-role-btn:hover { border-color:var(--border2); background:rgba(255,255,255,0.07); }
.auth-role-btn.selected { border-color:var(--cyan); background:var(--cyan-dim); }
.auth-role-name { font-size:0.84rem; font-weight:600; color:var(--text); margin-bottom:2px; letter-spacing:-0.01em; }
.auth-role-desc { font-size:0.68rem; color:var(--text3); }
.auth-role-btn.selected .auth-role-name { color:var(--cyan); }
.auth-field { margin-bottom:13px; }
.auth-field label { font-size:0.7rem; font-weight:500; letter-spacing:0.04em; color:var(--text3); display:block; margin-bottom:5px; text-transform:uppercase; }
.auth-input {
  width:100%; padding:10px 13px;
  background:rgba(255,255,255,0.06); border:1px solid var(--border);
  border-radius:10px; font-family:inherit; font-size:0.9rem; color:var(--text);
  outline:none; transition:all .15s;
}
.auth-input::placeholder { color:var(--text3); }
.auth-input:focus { border-color:var(--cyan); background:rgba(10,132,255,0.07); box-shadow:0 0 0 3px rgba(10,132,255,0.18); }
.auth-submit {
  width:100%; padding:12px;
  background:var(--cyan); color:#fff;
  border:none; border-radius:980px;
  font-family:inherit; font-size:0.88rem; font-weight:600;
  letter-spacing:-0.01em; cursor:pointer; margin-top:6px;
  transition:all .15s; box-shadow:0 4px 16px rgba(10,132,255,0.35);
}
.auth-submit:hover { background:#0070e0; transform:scale(1.015); box-shadow:0 6px 24px rgba(10,132,255,0.45); }
.auth-demo { text-align:center; margin-top:16px; font-size:0.74rem; color:var(--text3); }
.auth-demo a { color:var(--cyan); cursor:pointer; text-decoration:none; }
.auth-demo a:hover { text-decoration:underline; }
.auth-error { background:var(--red-dim); border:1px solid rgba(255,69,58,0.28); border-radius:10px; padding:9px 13px; font-size:0.8rem; color:var(--red); margin-bottom:13px; }

/* ‚îÄ‚îÄ APP LAYOUT ‚îÄ‚îÄ */
.app { display:flex; min-height:100vh; }

/* ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ */
.sidebar {
  width:228px; flex-shrink:0;
  background:rgba(17,17,17,0.96);
  border-right:1px solid var(--border);
  display:flex; flex-direction:column;
  position:fixed; top:0; left:0; bottom:0; z-index:50;
}
.sidebar-logo {
  padding:20px 18px;
  border-bottom:1px solid var(--border);
  display:flex; align-items:center; gap:10px;
}
.sidebar-logo-icon {
  width:30px; height:30px; border-radius:8px;
  background:linear-gradient(135deg,var(--cyan),var(--purple));
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 2px 10px rgba(10,132,255,0.3); flex-shrink:0;
  border:none;
}
.sidebar-logo-text { font-size:1.05rem; font-weight:700; letter-spacing:-0.02em; }
.sidebar-logo-text span { background:linear-gradient(135deg,var(--cyan),var(--purple)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
.sidebar-nav { flex:1; padding:10px 8px; overflow-y:auto; }
.nav-group-label { font-size:0.62rem; font-weight:600; letter-spacing:0.08em; text-transform:uppercase; color:var(--text3); padding:10px 10px 4px; }
.nav-item {
  display:flex; align-items:center; gap:9px;
  padding:8px 10px; border-radius:9px;
  font-size:0.85rem; font-weight:400; color:var(--text2);
  cursor:pointer; transition:all .13s; border:none; background:none; width:100%; text-align:left;
  margin-bottom:1px;
}
.nav-item:hover { background:rgba(255,255,255,0.05); color:var(--text); }
.nav-item.active { background:var(--cyan-dim); color:var(--cyan); font-weight:500; border-left:none; margin-left:0; padding-left:10px; }
.nav-item-icon { width:18px; text-align:center; font-size:0.8rem; flex-shrink:0; }
.nav-badge { margin-left:auto; font-size:0.62rem; background:var(--surface3); border:1px solid var(--border2); padding:1px 7px; border-radius:980px; }
.nav-item.active .nav-badge { background:rgba(10,132,255,0.2); border-color:rgba(10,132,255,0.4); color:var(--cyan); }
.sidebar-user {
  padding:12px 14px; border-top:1px solid var(--border);
  display:flex; align-items:center; gap:10px;
  cursor:pointer; transition:background .13s;
}
.sidebar-user:hover { background:rgba(255,255,255,0.04); }
.user-avatar {
  width:30px; height:30px; border-radius:50%;
  background:linear-gradient(135deg,var(--cyan),var(--purple));
  display:flex; align-items:center; justify-content:center;
  font-size:0.72rem; font-weight:700; color:#fff; flex-shrink:0;
  border:none;
}
.user-name { font-size:0.8rem; font-weight:500; color:var(--text); }
.user-role { font-size:0.66rem; color:var(--text3); }
.user-signout { margin-left:auto; font-size:0.7rem; color:var(--text3); }

/* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
.main { margin-left:228px; flex:1; display:flex; flex-direction:column; min-height:100vh; }
.topbar {
  position:sticky; top:0; z-index:40;
  display:flex; align-items:center; justify-content:space-between;
  padding:0 28px; height:52px;
  background:rgba(0,0,0,0.75);
  backdrop-filter:blur(24px) saturate(180%);
  -webkit-backdrop-filter:blur(24px) saturate(180%);
  border-bottom:1px solid var(--border);
}
.topbar-breadcrumb { display:flex; align-items:center; gap:8px; font-size:0.8rem; color:var(--text3); }
.topbar-breadcrumb span { color:var(--text2); font-weight:500; }
.topbar-breadcrumb .sep { color:var(--text3); }
.topbar-right { display:flex; gap:8px; align-items:center; }
.status-dot { width:7px; height:7px; border-radius:50%; background:var(--green); box-shadow:0 0 6px var(--green); animation:pulse 2s infinite; }
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
.topbar-time { font-size:0.76rem; color:var(--text3); font-variant-numeric:tabular-nums; }

/* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
.btn {
  display:inline-flex; align-items:center; gap:6px;
  font-family:inherit; font-size:0.8rem; font-weight:500;
  padding:7px 16px; border-radius:980px; cursor:pointer; border:none; transition:all .15s;
}
.btn-primary { background:var(--cyan); color:#fff; box-shadow:0 2px 12px rgba(10,132,255,0.3); }
.btn-primary:hover { background:#0070e0; box-shadow:0 4px 18px rgba(10,132,255,0.4); transform:scale(1.02); }
.btn-secondary { background:var(--surface2); color:var(--text); border:1px solid var(--border2); border-radius:980px; }
.btn-secondary:hover { background:var(--surface3); }
.btn-ghost { background:transparent; color:var(--text2); padding:6px 10px; }
.btn-ghost:hover { background:rgba(255,255,255,0.06); color:var(--text); border-radius:8px; }
.btn-danger { background:var(--red-dim); color:var(--red); border:1px solid rgba(255,69,58,0.28); border-radius:980px; }
.btn-danger:hover { background:rgba(255,69,58,0.22); }
.btn-sm { padding:5px 12px; font-size:0.74rem; }

/* ‚îÄ‚îÄ CONTENT ‚îÄ‚îÄ */
.content { padding:24px 28px; flex:1; }

/* ‚îÄ‚îÄ STATS ‚îÄ‚îÄ */
.stats-row { display:grid; grid-template-columns:repeat(4,1fr); gap:12px; margin-bottom:22px; }
.stat-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:14px; padding:18px 20px;
  position:relative; overflow:hidden;
  transition:transform .2s,box-shadow .2s;
}
.stat-card:hover { transform:translateY(-2px); box-shadow:0 12px 40px rgba(0,0,0,0.4); }
.stat-card::before { content:''; position:absolute; top:0; left:0; right:0; height:1px; background:linear-gradient(90deg,transparent,rgba(255,255,255,0.07),transparent); }
/* top accent line becomes bottom glow via pseudo */
.stat-card.c-cyan  { box-shadow:inset 0 1px 0 rgba(10,132,255,0.3); }
.stat-card.c-green { box-shadow:inset 0 1px 0 rgba(48,209,88,0.3); }
.stat-card.c-yellow{ box-shadow:inset 0 1px 0 rgba(255,159,10,0.3); }
.stat-card.c-red   { box-shadow:inset 0 1px 0 rgba(255,69,58,0.3); }
.stat-label { font-size:0.7rem; font-weight:500; letter-spacing:0.02em; color:var(--text3); margin-bottom:12px; }
.stat-value { font-size:1.9rem; font-weight:700; letter-spacing:-0.04em; line-height:1; margin-bottom:5px; }
.stat-value.c-cyan   { color:var(--cyan); }
.stat-value.c-green  { color:var(--green); }
.stat-value.c-yellow { color:var(--yellow); }
.stat-value.c-red    { color:var(--red); }
.stat-sub { font-size:0.7rem; color:var(--text3); }

/* ‚îÄ‚îÄ TOOLBAR ‚îÄ‚îÄ */
.toolbar { display:flex; align-items:center; gap:10px; margin-bottom:16px; flex-wrap:wrap; }
.search-wrap { position:relative; flex:1; min-width:180px; }
.search-wrap svg { position:absolute; left:11px; top:50%; transform:translateY(-50%); color:var(--text3); pointer-events:none; }
.search-input {
  width:100%; padding:8px 12px 8px 34px;
  background:var(--surface2); border:1px solid var(--border);
  border-radius:980px; font-family:inherit; font-size:0.82rem; color:var(--text);
  outline:none; transition:all .15s;
}
.search-input::placeholder { color:var(--text3); }
.search-input:focus { border-color:var(--cyan); background:var(--surface); box-shadow:0 0 0 3px rgba(10,132,255,0.15); }
.filter-select {
  padding:8px 12px; background:var(--surface2); border:1px solid var(--border);
  border-radius:980px; font-family:inherit; font-size:0.8rem; color:var(--text);
  outline:none; cursor:pointer; transition:all .15s;
}
.filter-select:focus { border-color:var(--cyan); }
option { background:var(--surface2); color:var(--text); }

/* ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ */
.table-wrap { background:var(--surface); border:1px solid var(--border); border-radius:14px; overflow:hidden; }
.table-header-row {
  display:grid; grid-template-columns:2fr 1fr 1fr 1fr 1fr 100px;
  padding:9px 18px; border-bottom:1px solid var(--border);
  background:var(--surface2);
}
.th {
  font-size:0.68rem; font-weight:600; text-transform:uppercase; letter-spacing:0.06em;
  color:var(--text3); display:flex; align-items:center; gap:5px; cursor:pointer; user-select:none;
}
.th:hover { color:var(--text2); }
.th .sort-arrow { font-size:0.6rem; opacity:.3; }
.th .sort-arrow.active { opacity:1; color:var(--cyan); }
.table-row {
  display:grid; grid-template-columns:2fr 1fr 1fr 1fr 1fr 100px;
  padding:13px 18px; border-bottom:1px solid var(--border);
  transition:background .12s; align-items:center;
  animation:rowIn .2s ease; cursor:pointer;
}
@keyframes rowIn{from{opacity:0;transform:translateX(-3px)}to{opacity:1;transform:none}}
.table-row:last-child { border-bottom:none; }
.table-row:hover { background:rgba(255,255,255,0.025); }
.td { font-size:0.82rem; color:var(--text2); }
.td-name { color:var(--text); font-weight:500; font-size:0.85rem; }
.td-sku { font-size:0.68rem; color:var(--text3); margin-top:2px; font-family:var(--mono); }
.td-actions { display:flex; gap:4px; justify-content:flex-end; }
.icon-btn {
  width:28px; height:28px; border-radius:7px;
  background:none; border:none; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  font-size:0.78rem; color:var(--text3); transition:all .12s;
}
.icon-btn:hover { background:var(--surface3); color:var(--text2); }

/* ‚îÄ‚îÄ STATUS BADGES ‚îÄ‚îÄ */
.badge {
  display:inline-flex; align-items:center; gap:5px;
  padding:3px 10px; border-radius:980px;
  font-size:0.68rem; font-weight:500;
}
.badge::before { content:''; width:5px; height:5px; border-radius:50%; flex-shrink:0; }
.badge-in-stock  { background:var(--green-dim); color:var(--green); border:1px solid rgba(48,209,88,0.25); }
.badge-in-stock::before { background:var(--green); box-shadow:0 0 4px var(--green); }
.badge-low-stock { background:var(--yellow-dim); color:var(--yellow); border:1px solid rgba(255,159,10,0.25); }
.badge-low-stock::before { background:var(--yellow); }
.badge-ordered   { background:var(--blue-dim); color:var(--blue); border:1px solid rgba(10,132,255,0.25); }
.badge-ordered::before { background:var(--blue); }
.badge-discontinued { background:var(--red-dim); color:var(--red); border:1px solid rgba(255,69,58,0.25); }
.badge-discontinued::before { background:var(--red); }

/* ‚îÄ‚îÄ QUANTITY BAR ‚îÄ‚îÄ */
.qty-wrap { display:flex; align-items:center; gap:8px; }
.qty-bar-track { flex:1; height:3px; background:var(--surface3); border-radius:2px; overflow:hidden; max-width:60px; }
.qty-bar-fill { height:100%; border-radius:2px; transition:width .3s; }

/* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
.empty { text-align:center; padding:64px 20px; }
.empty-icon { font-size:2.5rem; color:var(--text3); margin-bottom:14px; opacity:.4; }
.empty h3 { font-size:1rem; font-weight:600; color:var(--text2); margin-bottom:6px; }
.empty p { font-size:0.8rem; color:var(--text3); }

/* ‚îÄ‚îÄ AI PANEL ‚îÄ‚îÄ */
.ai-panel {
  background:linear-gradient(135deg,rgba(10,132,255,0.07),rgba(191,90,242,0.05));
  border:1px solid rgba(10,132,255,0.18);
  border-radius:12px; padding:14px 16px; margin-bottom:20px;
  display:flex; align-items:flex-start; gap:12px;
}
.ai-panel-icon {
  width:30px; height:30px; border-radius:8px; flex-shrink:0;
  background:linear-gradient(135deg,var(--cyan),var(--purple));
  display:flex; align-items:center; justify-content:center;
  font-size:0.72rem; font-weight:700; color:#fff;
  box-shadow:none; border:none;
}
.ai-panel-label { font-size:0.66rem; font-weight:600; text-transform:uppercase; letter-spacing:0.08em; color:var(--cyan); margin-bottom:4px; }
.ai-panel-text { font-size:0.8rem; color:var(--text2); line-height:1.6; }
.ai-panel-text strong { color:var(--text); }

/* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
.overlay {
  position:fixed; inset:0; background:rgba(0,0,0,0.72);
  backdrop-filter:blur(14px) saturate(180%);
  -webkit-backdrop-filter:blur(14px) saturate(180%);
  z-index:100; display:flex; align-items:center; justify-content:center; padding:20px;
  animation:fadeIn .16s ease;
}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal {
  background:var(--surface); border:1px solid var(--border2);
  border-radius:20px; width:100%; max-width:520px;
  max-height:90vh; overflow-y:auto;
  animation:modalIn .24s cubic-bezier(.34,1.3,.64,1);
  box-shadow:0 32px 80px rgba(0,0,0,0.7), 0 0 0 0.5px rgba(255,255,255,0.05) inset;
}
.modal::-webkit-scrollbar{width:3px}
.modal::-webkit-scrollbar-thumb{background:var(--surface3);border-radius:3px}
@keyframes modalIn{from{transform:translateY(16px) scale(.97);opacity:0}to{transform:none;opacity:1}}
.modal-header {
  padding:18px 22px;
  border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between;
}
.modal-title { font-size:1rem; font-weight:600; letter-spacing:-0.02em; color:var(--text); }
.modal-close {
  width:28px; height:28px; border-radius:50%;
  background:var(--surface3); border:none; cursor:pointer;
  color:var(--text2); font-size:0.8rem; display:flex; align-items:center; justify-content:center;
  transition:all .13s;
}
.modal-close:hover { background:rgba(255,255,255,0.14); color:var(--text); }
.modal-body { padding:20px 22px 22px; }
.form-group { margin-bottom:14px; }
.form-label { font-size:0.68rem; font-weight:500; text-transform:uppercase; letter-spacing:0.06em; color:var(--text3); display:block; margin-bottom:5px; }
.form-input, .form-select, .form-textarea {
  width:100%; padding:9px 12px;
  background:var(--surface2); border:1px solid var(--border);
  border-radius:10px; font-family:inherit; font-size:0.85rem; color:var(--text);
  outline:none; transition:all .15s;
}
.form-input::placeholder { color:var(--text3); }
.form-input:focus,.form-select:focus,.form-textarea:focus {
  border-color:var(--cyan); box-shadow:0 0 0 3px rgba(10,132,255,0.15); background:rgba(10,132,255,0.04);
}
.form-textarea { resize:vertical; min-height:72px; line-height:1.5; }
.form-row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.form-actions { display:flex; gap:8px; justify-content:flex-end; padding-top:16px; border-top:1px solid var(--border); margin-top:16px; }

/* ‚îÄ‚îÄ DETAIL MODAL ‚îÄ‚îÄ */
.detail-header { padding:22px; border-bottom:1px solid var(--border); }
.detail-sku { font-size:0.68rem; color:var(--text3); letter-spacing:0.08em; text-transform:uppercase; margin-bottom:6px; font-family:var(--mono); }
.detail-name { font-size:1.2rem; font-weight:700; letter-spacing:-0.02em; color:var(--text); margin-bottom:10px; }
.detail-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:16px; }
.detail-field { background:var(--surface2); border:1px solid var(--border); border-radius:10px; padding:11px 13px; }
.detail-field-label { font-size:0.64rem; font-weight:500; text-transform:uppercase; letter-spacing:0.07em; color:var(--text3); margin-bottom:4px; }
.detail-field-value { font-size:0.88rem; font-weight:500; color:var(--text); }
.detail-desc { font-size:0.82rem; color:var(--text2); line-height:1.65; margin-top:14px; padding-top:14px; border-top:1px solid var(--border); }
.detail-footer { padding:16px 22px; border-top:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; }

/* ‚îÄ‚îÄ STATUS UPDATE INLINE ‚îÄ‚îÄ */
.status-row { display:flex; gap:6px; flex-wrap:wrap; margin-top:14px; }
.status-opt {
  padding:6px 14px; border-radius:980px; border:1px solid var(--border);
  background:var(--surface2); font-family:inherit; font-size:0.74rem;
  font-weight:500; cursor:pointer; transition:all .13s; color:var(--text2);
}
.status-opt:hover { border-color:var(--border2); color:var(--text); }
.status-opt.s-in-stock   { border-color:rgba(48,209,88,.4); background:var(--green-dim); color:var(--green); }
.status-opt.s-low-stock  { border-color:rgba(255,159,10,.4); background:var(--yellow-dim); color:var(--yellow); }
.status-opt.s-ordered    { border-color:rgba(10,132,255,.4); background:var(--blue-dim); color:var(--blue); }
.status-opt.s-discontinued { border-color:rgba(255,69,58,.4); background:var(--red-dim); color:var(--red); }

/* ‚îÄ‚îÄ ROLE GATE ‚îÄ‚îÄ */
.role-locked { display:flex; align-items:center; gap:6px; font-size:0.76rem; color:var(--text3); }

/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
.toast {
  position:fixed; bottom:24px; right:24px;
  background:var(--surface2); border:1px solid var(--border2);
  border-radius:12px; padding:11px 18px;
  font-size:0.82rem; color:var(--text);
  z-index:200; display:flex; align-items:center; gap:10px;
  animation:toastIn .22s cubic-bezier(.34,1.4,.64,1), toastOut .22s ease 2.5s forwards;
  box-shadow:0 8px 28px rgba(0,0,0,0.5), 0 0 0 0.5px rgba(255,255,255,0.05) inset;
  backdrop-filter:blur(10px);
}
.toast-bar { width:3px; height:28px; border-radius:2px; flex-shrink:0; }
@keyframes toastIn{from{transform:translateY(12px) scale(.95);opacity:0}to{transform:none;opacity:1}}
@keyframes toastOut{from{opacity:1}to{opacity:0;transform:translateY(8px)}}

/* ‚îÄ‚îÄ ROLE BADGE ‚îÄ‚îÄ */
.role-tag {
  font-size:0.64rem; font-weight:500; letter-spacing:0.04em; text-transform:uppercase;
  padding:3px 9px; border-radius:980px; border:1px solid var(--border2); color:var(--text3);
}
.role-tag.admin   { border-color:rgba(10,132,255,.35); color:var(--cyan); background:var(--cyan-dim); }
.role-tag.manager { border-color:rgba(48,209,88,.35); color:var(--green); background:var(--green-dim); }
.role-tag.viewer  { border-color:var(--border2); color:var(--text3); }

/* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
@media(max-width:768px){
  .sidebar{display:none} .main{margin-left:0}
  .stats-row{grid-template-columns:repeat(2,1fr)}
  .form-row{grid-template-columns:1fr}
  .table-header-row,.table-row{grid-template-columns:2fr 1fr 1fr 90px}
  .table-header-row .th:nth-child(3),.table-header-row .th:nth-child(5),
  .table-row .td:nth-child(3),.table-row .td:nth-child(5){display:none}
  .content{padding:16px 14px} .topbar{padding:0 14px}
}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useMemo } = React;

/* ‚îÄ‚îÄ CONSTANTS ‚îÄ‚îÄ */
const ROLES = {
  admin:   { label:'Admin',    can:['view','create','edit','delete','status'] },
  manager: { label:'Manager',  can:['view','create','edit','status'] },
  viewer:  { label:'Viewer',   can:['view'] },
};
const can = (role, action) => ROLES[role]?.can.includes(action);

const STATUSES = {
  'in-stock':     { label:'In Stock',     cls:'badge-in-stock',     opt:'s-in-stock'    },
  'low-stock':    { label:'Low Stock',    cls:'badge-low-stock',    opt:'s-low-stock'   },
  'ordered':      { label:'Ordered',      cls:'badge-ordered',      opt:'s-ordered'     },
  'discontinued': { label:'Discontinued', cls:'badge-discontinued', opt:'s-discontinued'},
};

const CATEGORIES = ['Electronics','Office Supplies','Furniture','Hardware','Safety','Packaging','Cleaning','Tools','Other'];

const sku = () => 'SKU-' + Math.random().toString(36).slice(2,7).toUpperCase();

const SEED = [
  {id:1,name:'Mechanical Keyboard MX Blue',sku:'SKU-KBD01',category:'Electronics',quantity:24,maxQty:50,price:129.99,status:'in-stock',description:'Full-size mechanical keyboard with Cherry MX Blue switches. Ideal for office workstations.',supplier:'TechDist Co.'},
  {id:2,name:'Ergonomic Office Chair',sku:'SKU-CHR02',category:'Furniture',quantity:6,maxQty:20,price:349.00,status:'low-stock',description:'Lumbar support mesh chair with adjustable armrests and height.',supplier:'FurnWorld'},
  {id:3,name:'USB-C Hub 7-in-1',sku:'SKU-HUB03',category:'Electronics',quantity:0,maxQty:40,price:49.99,status:'ordered',description:'7-port USB-C hub with HDMI 4K, 3x USB-A, SD card, and 100W PD.',supplier:'TechDist Co.'},
  {id:4,name:'Whiteboard Markers Set',sku:'SKU-WBM04',category:'Office Supplies',quantity:120,maxQty:200,price:12.50,status:'in-stock',description:'Assorted 12-pack dry-erase markers. Odorless, low-VOC.',supplier:'SupplyPlus'},
  {id:5,name:'Safety Helmet Class E',sku:'SKU-SAF05',category:'Safety',quantity:3,maxQty:30,price:28.00,status:'low-stock',description:'ANSI/ISEA Z89.1 Class E rated safety helmet. Adjustable suspension.',supplier:'SafetyFirst LLC'},
  {id:6,name:'Label Printer LW-400',sku:'SKU-LBL06',category:'Tools',quantity:8,maxQty:15,price:89.99,status:'in-stock',description:'Thermal label printer, compatible with DYMO labels. USB + Bluetooth.',supplier:'PrintWorld'},
  {id:7,name:'Bubble Wrap Roll 24"',sku:'SKU-PKG07',category:'Packaging',quantity:0,maxQty:10,price:22.00,status:'discontinued',description:'Small bubble 24" x 50ft roll. No longer carried by primary supplier.',supplier:'PackCo'},
  {id:8,name:'Standing Desk Converter',sku:'SKU-DSK08',category:'Furniture',quantity:11,maxQty:25,price:219.00,status:'in-stock',description:'Height-adjustable desk converter. Fits monitors up to 27". Easy lift mechanism.',supplier:'FurnWorld'},
];

const AI_INSIGHTS = [
  s => `<strong>${s.filter(i=>i.status==='low-stock').length} items</strong> are low on stock. Consider reordering: ${s.filter(i=>i.status==='low-stock').map(i=>i.name.split(' ')[0]).join(', ')}.`,
  s => `Total inventory value: <strong>$${s.reduce((a,i)=>a+i.price*i.quantity,0).toLocaleString('en-US',{minimumFractionDigits:2})}</strong> across ${s.length} SKUs.`,
  s => `<strong>${s.filter(i=>i.status==='discontinued').length} discontinued item(s)</strong> still in your catalog. Review and archive if no longer needed.`,
  s => `Your best-stocked category: <strong>${(()=>{const cats={};s.forEach(i=>{cats[i.category]=(cats[i.category]||0)+i.quantity});return Object.entries(cats).sort((a,b)=>b[1]-a[1])[0]?.[0]||'N/A'})()}</strong>.`,
];

const AI_SUGGESTIONS = [
  i => `"${i.name}" has ${i.quantity} units left out of max ${i.maxQty}. ${i.quantity/i.maxQty < 0.2 ? 'Recommend reordering soon.' : 'Stock level looks healthy.'}`,
  i => `Supplier "${i.supplier}" also provides similar items. Bundle orders to reduce shipping costs.`,
  i => `At current stock, "${i.name}" ${i.quantity > 0 ? `will last approximately ${Math.round(i.quantity / 2)} weeks at average consumption.` : 'is out of stock ‚Äî order immediately.'}`,
  i => `Price point $${i.price.toFixed(2)} for "${i.name}" is within market range for ${i.category}.`,
];

const fmtCurrency = n => '$' + Number(n).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,',');
const qtyColor = (qty, max) => {
  const r = qty / max;
  if (r === 0) return 'var(--red)';
  if (r < 0.2) return 'var(--red)';
  if (r < 0.4) return 'var(--yellow)';
  return 'var(--green)';
};

/* ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ */
function Clock() {
  const [t, setT] = useState(new Date());
  useEffect(() => { const id = setInterval(() => setT(new Date()), 1000); return () => clearInterval(id); }, []);
  return <span className="topbar-time">{t.toLocaleTimeString('en-US', {hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false})}</span>;
}

/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
function Toast({ msg, color='var(--cyan)', onDone }) {
  useEffect(() => { const t = setTimeout(onDone, 2800); return () => clearTimeout(t); }, []);
  return (
    <div className="toast">
      <div className="toast-bar" style={{background:color}}/>
      {msg}
    </div>
  );
}

/* ‚îÄ‚îÄ STATUS BADGE ‚îÄ‚îÄ */
const StatusBadge = ({ status }) => {
  const s = STATUSES[status];
  return <span className={`badge ${s.cls}`}>{s.label}</span>;
};

/* ‚îÄ‚îÄ AUTH ‚îÄ‚îÄ */
function Auth({ onLogin }) {
  const [role, setRole] = useState('admin');
  const [user, setUser] = useState('');
  const [pass, setPass] = useState('');
  const [err, setErr]   = useState('');

  const submit = e => {
    e.preventDefault();
    if (!user.trim() || !pass.trim()) { setErr('Username and password required.'); return; }
    onLogin({ name: user.trim(), role, initials: user.trim().slice(0,2).toUpperCase() });
  };
  const demo = (r='admin') => onLogin({ name: r === 'admin' ? 'Alex Admin' : r === 'manager' ? 'Morgan Mgr' : 'Val Viewer', role: r, initials: r === 'admin' ? 'AA' : r === 'manager' ? 'MM' : 'VV' });

  return (
    <div className="auth-screen">
      <div className="auth-grid-bg"/>
      <div className="auth-panel">
        <div className="auth-header">
          <div className="auth-logo-icon">
            <svg width="16" height="16" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24">
              <rect x="2" y="7" width="20" height="14" rx="1"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/><line x1="12" y1="12" x2="12" y2="16"/><circle cx="12" cy="12" r="1" fill="currentColor"/>
            </svg>
          </div>
          <div>
            <div className="auth-logo-name">Stock<span>OS</span></div>
            <div className="auth-logo-sub">Inventory Management System</div>
          </div>
        </div>
        <div className="auth-body">
          {err && <div className="auth-error">‚ö† {err}</div>}
          <div className="auth-section-label">Select Role</div>
          <div className="auth-role-grid">
            {Object.entries(ROLES).map(([k,v]) => (
              <button key={k} className={`auth-role-btn${role===k?' selected':''}`} onClick={() => { setRole(k); setErr(''); }}>
                <div className="auth-role-name">{v.label}</div>
                <div className="auth-role-desc">
                  {k==='admin'?'Full access':''}
                  {k==='manager'?'Edit, no delete':''}
                  {k==='viewer'?'Read only':''}
                </div>
              </button>
            ))}
          </div>
          <form onSubmit={submit}>
            <div className="auth-section-label" style={{marginBottom:10}}>Credentials</div>
            <div className="auth-field">
              <label>Username</label>
              <input className="auth-input" type="text" placeholder="enter username"
                value={user} onChange={e=>{setUser(e.target.value);setErr('');}} />
            </div>
            <div className="auth-field">
              <label>Password</label>
              <input className="auth-input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                value={pass} onChange={e=>{setPass(e.target.value);setErr('');}} />
            </div>
            <button className="auth-submit" type="submit">Sign In ‚Üí</button>
          </form>
          <div className="auth-demo">
            Quick demo:&nbsp;
            <a onClick={()=>demo('admin')}>Admin</a> ¬∑&nbsp;
            <a onClick={()=>demo('manager')}>Manager</a> ¬∑&nbsp;
            <a onClick={()=>demo('viewer')}>Viewer</a>
          </div>
        </div>
      </div>
    </div>
  );
}

/* ‚îÄ‚îÄ ITEM FORM ‚îÄ‚îÄ */
function ItemForm({ item, onSave, onCancel, role }) {
  const [f, setF] = useState(item || { name:'', sku:sku(), category:'Electronics', quantity:'', maxQty:'', price:'', status:'in-stock', description:'', supplier:'' });
  const [aiMsg, setAiMsg] = useState('');
  const set = (k,v) => setF(p=>({...p,[k]:v}));

  const getAI = () => {
    const fn = AI_SUGGESTIONS[Math.floor(Math.random()*AI_SUGGESTIONS.length)];
    setAiMsg(fn({...f, quantity:Number(f.quantity)||0, maxQty:Number(f.maxQty)||100, price:Number(f.price)||0}));
  };

  const submit = e => {
    e.preventDefault();
    if (!f.name.trim() || !f.quantity) return;
    onSave({ ...f, id: f.id||Date.now(), quantity:Number(f.quantity), maxQty:Number(f.maxQty)||100, price:Number(f.price)||0 });
  };

  return (
    <form onSubmit={submit}>
      <div className="form-group">
        <label className="form-label">Item Name *</label>
        <input className="form-input" type="text" placeholder="e.g. Wireless Mouse Logitech MX3"
          value={f.name} onChange={e=>set('name',e.target.value)} required/>
      </div>
      <div className="form-row">
        <div className="form-group">
          <label className="form-label">SKU</label>
          <input className="form-input" type="text" value={f.sku} onChange={e=>set('sku',e.target.value)}/>
        </div>
        <div className="form-group">
          <label className="form-label">Category</label>
          <select className="form-input form-select" value={f.category} onChange={e=>set('category',e.target.value)}>
            {CATEGORIES.map(c=><option key={c}>{c}</option>)}
          </select>
        </div>
      </div>
      <div className="form-row">
        <div className="form-group">
          <label className="form-label">Quantity *</label>
          <input className="form-input" type="number" min="0" placeholder="0"
            value={f.quantity} onChange={e=>set('quantity',e.target.value)} required/>
        </div>
        <div className="form-group">
          <label className="form-label">Max Capacity</label>
          <input className="form-input" type="number" min="1" placeholder="100"
            value={f.maxQty} onChange={e=>set('maxQty',e.target.value)}/>
        </div>
      </div>
      <div className="form-row">
        <div className="form-group">
          <label className="form-label">Unit Price ($)</label>
          <input className="form-input" type="number" min="0" step="0.01" placeholder="0.00"
            value={f.price} onChange={e=>set('price',e.target.value)}/>
        </div>
        <div className="form-group">
          <label className="form-label">Status</label>
          <select className="form-input form-select" value={f.status} onChange={e=>set('status',e.target.value)}>
            {Object.entries(STATUSES).map(([k,v])=><option key={k} value={k}>{v.label}</option>)}
          </select>
        </div>
      </div>
      <div className="form-group">
        <label className="form-label">Supplier</label>
        <input className="form-input" type="text" placeholder="e.g. TechDist Co."
          value={f.supplier} onChange={e=>set('supplier',e.target.value)}/>
      </div>
      <div className="form-group">
        <label className="form-label">Description</label>
        <textarea className="form-input form-textarea" placeholder="Item details, notes..."
          value={f.description} onChange={e=>set('description',e.target.value)}/>
      </div>

      <button type="button" className="btn btn-secondary btn-sm" onClick={getAI} style={{marginBottom: aiMsg?0:4}}>
        ‚ú¶ AI Analysis
      </button>
      {aiMsg && (
        <div style={{background:'linear-gradient(135deg,rgba(10,132,255,0.07),rgba(191,90,242,0.05))',border:'1px solid rgba(10,132,255,0.18)',borderRadius:'12px',padding:'12px 14px',marginTop:8,marginBottom:4}}>
          <div style={{fontSize:'0.66rem',fontWeight:600,textTransform:'uppercase',letterSpacing:'0.08em',color:'var(--cyan)',marginBottom:5}}>‚ú¶ AI Analysis</div>
          <div style={{fontSize:'0.8rem',color:'var(--text2)',lineHeight:1.6}}>{aiMsg}</div>
        </div>
      )}

      <div className="form-actions">
        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
        <button type="submit" className="btn btn-primary">{item ? 'Save Changes' : 'Add Item'}</button>
      </div>
    </form>
  );
}

/* ‚îÄ‚îÄ ITEM DETAIL ‚îÄ‚îÄ */
function ItemDetail({ item, onClose, onEdit, onDelete, onStatusChange, role }) {
  return (
    <div>
      <div className="detail-header">
        <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start'}}>
          <div>
            <div className="detail-sku">{item.sku}</div>
            <div className="detail-name">{item.name}</div>
            <StatusBadge status={item.status}/>
          </div>
          <button className="modal-close" onClick={onClose}>‚úï</button>
        </div>
        {can(role,'status') && (
          <div>
            <div style={{fontSize:'0.68rem',fontWeight:500,textTransform:'uppercase',letterSpacing:'0.06em',color:'var(--text3)',marginTop:14,marginBottom:8}}>Update Status</div>
            <div className="status-row">
              {Object.entries(STATUSES).map(([k,v])=>(
                <button key={k} className={`status-opt${item.status===k?' '+STATUSES[k].opt:''}`}
                  onClick={()=>onStatusChange(item.id,k)}>
                  {v.label}
                </button>
              ))}
            </div>
          </div>
        )}
        <div className="detail-grid">
          {[
            ['Category', item.category],
            ['Supplier', item.supplier||'‚Äî'],
            ['Quantity', `${item.quantity} / ${item.maxQty} units`],
            ['Unit Price', fmtCurrency(item.price)],
            ['Total Value', fmtCurrency(item.price * item.quantity)],
            ['Stock Level', `${Math.round(item.quantity/item.maxQty*100)}%`],
          ].map(([l,v])=>(
            <div key={l} className="detail-field">
              <div className="detail-field-label">{l}</div>
              <div className="detail-field-value">{v}</div>
            </div>
          ))}
        </div>
        {item.description && (
          <div className="detail-desc">{item.description}</div>
        )}
      </div>
      <div className="detail-footer">
        {can(role,'delete')
          ? <button className="btn btn-danger btn-sm" onClick={()=>{onDelete(item.id);onClose();}}>Delete</button>
          : <div className="role-locked">üîí Insufficient permissions</div>
        }
        <div style={{display:'flex',gap:8}}>
          <button className="btn btn-secondary btn-sm" onClick={onClose}>Close</button>
          {can(role,'edit')
            ? <button className="btn btn-primary btn-sm" onClick={()=>{onEdit(item);onClose();}}>Edit Item</button>
            : null
          }
        </div>
      </div>
    </div>
  );
}

/* ‚îÄ‚îÄ MAIN DASHBOARD ‚îÄ‚îÄ */
function Dashboard({ user, onLogout }) {
  const [items, setItems] = useState(SEED);
  const [modal, setModal] = useState(null);
  const [search, setSearch] = useState('');
  const [filterCat, setFilterCat] = useState('all');
  const [filterStatus, setFilterStatus] = useState('all');
  const [sortBy, setSortBy] = useState('name');
  const [sortDir, setSortDir] = useState('asc');
  const [navItem, setNavItem] = useState('inventory');
  const [toast, setToast] = useState(null);
  const [aiIdx] = useState(()=>Math.floor(Math.random()*AI_INSIGHTS.length));

  const showToast = (msg, color='var(--cyan)') => setToast({msg,color});

  const filtered = useMemo(() => {
    let list = [...items];
    if (filterCat !== 'all') list = list.filter(i => i.category === filterCat);
    if (filterStatus !== 'all') list = list.filter(i => i.status === filterStatus);
    if (search.trim()) {
      const q = search.toLowerCase();
      list = list.filter(i =>
        i.name.toLowerCase().includes(q) ||
        i.sku.toLowerCase().includes(q) ||
        i.category.toLowerCase().includes(q) ||
        (i.supplier||'').toLowerCase().includes(q)
      );
    }
    list.sort((a,b) => {
      let va = a[sortBy], vb = b[sortBy];
      if (typeof va === 'string') va = va.toLowerCase();
      if (typeof vb === 'string') vb = vb.toLowerCase();
      return sortDir === 'asc' ? (va > vb ? 1 : -1) : (va < vb ? 1 : -1);
    });
    return list;
  }, [items, filterCat, filterStatus, search, sortBy, sortDir]);

  const stats = useMemo(() => ({
    total: items.length,
    inStock: items.filter(i=>i.status==='in-stock').length,
    lowStock: items.filter(i=>i.status==='low-stock').length,
    totalValue: items.reduce((a,i)=>a+i.price*i.quantity,0),
  }), [items]);

  const handleSort = col => {
    if (sortBy === col) setSortDir(d => d === 'asc' ? 'desc' : 'asc');
    else { setSortBy(col); setSortDir('asc'); }
  };

  const saveItem = item => {
    setItems(prev => {
      const idx = prev.findIndex(i => i.id === item.id);
      if (idx >= 0) { const n=[...prev]; n[idx]=item; return n; }
      return [...prev, item];
    });
    setModal(null);
    showToast(items.find(i=>i.id===item.id) ? '‚úì Item updated' : '‚úì Item added to inventory', 'var(--green)');
  };
  const deleteItem = id => {
    setItems(prev => prev.filter(i => i.id !== id));
    showToast('‚úì Item removed', 'var(--red)');
  };
  const changeStatus = (id, status) => {
    setItems(prev => prev.map(i => i.id===id ? {...i,status} : i));
    showToast(`‚úì Status ‚Üí ${STATUSES[status].label}`, 'var(--cyan)');
    if (modal?.type==='detail') setModal(m=>({...m, item:{...m.item,status}}));
  };

  const openDetail = item => setModal({type:'detail', item});

  const NAVS = [
    {id:'inventory',icon:'üì¶',label:'Inventory',badge:items.length},
    {id:'low-stock',icon:'‚ö†Ô∏è',label:'Low Stock',badge:items.filter(i=>i.status==='low-stock').length},
    {id:'ordered',icon:'üîÑ',label:'On Order',badge:items.filter(i=>i.status==='ordered').length},
    {id:'discontinued',icon:'üö´',label:'Discontinued',badge:items.filter(i=>i.status==='discontinued').length},
  ];

  const handleNav = id => {
    setNavItem(id);
    if (id === 'inventory') setFilterStatus('all');
    else setFilterStatus(id);
  };

  const SortTh = ({ col, label }) => (
    <div className="th" onClick={() => handleSort(col)}>
      {label}
      <span className={`sort-arrow${sortBy===col?' active':''}`}>{sortBy===col&&sortDir==='desc'?'‚Üì':'‚Üë'}</span>
    </div>
  );

  const aiText = AI_INSIGHTS[aiIdx](items);

  return (
    <div className="app">
      {/* SIDEBAR */}
      <aside className="sidebar">
        <div className="sidebar-logo">
          <div className="sidebar-logo-icon">üì¶</div>
          <div className="sidebar-logo-text">Stock<span>OS</span></div>
        </div>

        <nav className="sidebar-nav">
          <div className="nav-group-label">Inventory</div>
          {NAVS.map(n => (
            <button key={n.id} className={`nav-item${navItem===n.id?' active':''}`} onClick={()=>handleNav(n.id)}>
              <span className="nav-item-icon">{n.icon}</span>
              {n.label}
              <span className="nav-badge">{n.badge}</span>
            </button>
          ))}
          <div className="nav-group-label" style={{marginTop:16}}>Reports</div>
          {[
            {id:'value',icon:'üí∞',label:'Valuation'},
            {id:'activity',icon:'üìã',label:'Audit Log'},
          ].map(n=>(
            <button key={n.id} className={`nav-item${navItem===n.id?' active':''}`}
              onClick={()=>{ setNavItem(n.id); showToast('Module coming soon', 'var(--yellow)'); }}>
              <span className="nav-item-icon">{n.icon}</span>
              {n.label}
            </button>
          ))}
        </nav>

        <div className="sidebar-user" onClick={onLogout} title="Sign out">
          <div className="user-avatar">{user.initials}</div>
          <div>
            <div className="user-name">{user.name}</div>
            <div className="user-role">{ROLES[user.role]?.label}</div>
          </div>
          <span className="user-signout">‚Ü©</span>
        </div>
      </aside>

      {/* MAIN */}
      <main className="main">
        <div className="topbar">
          <div className="topbar-breadcrumb">
            StockOS <span className="sep">/</span>
            <span>{navItem === 'inventory' ? 'All Items' : STATUSES[navItem]?.label || navItem.charAt(0).toUpperCase()+navItem.slice(1)}</span>
          </div>
          <div className="topbar-right">
            <div className="status-dot"/>
            <Clock/>
            <span className={`role-tag ${user.role}`}>{ROLES[user.role]?.label}</span>
            {can(user.role,'create') && (
              <button className="btn btn-primary btn-sm" onClick={()=>setModal({type:'create'})}>
                + Add Item
              </button>
            )}
          </div>
        </div>

        <div className="content">
          {/* STATS */}
          <div className="stats-row">
            {[
              {label:'Total SKUs',    value:stats.total,    cls:'c-cyan',   color:'c-cyan'},
              {label:'In Stock',      value:stats.inStock,  cls:'c-green',  color:'c-green'},
              {label:'Low / Ordered', value:stats.lowStock, cls:'c-yellow', color:'c-yellow'},
              {label:'Total Value',   value:fmtCurrency(stats.totalValue), cls:'c-cyan', color:'c-cyan', small:true},
            ].map((s,i)=>(
              <div key={i} className={`stat-card ${s.cls}`}>
                <div className="stat-label">{s.label}</div>
                <div className={`stat-value ${s.color}`} style={s.small?{fontSize:'1.3rem'}:{}}>{s.value}</div>
                <div className="stat-sub">
                  {i===0&&`${filtered.length} shown`}
                  {i===1&&`${Math.round(stats.inStock/stats.total*100)}% of catalog`}
                  {i===2&&`${items.filter(i=>i.status==='ordered').length} on order`}
                  {i===3&&`avg ${fmtCurrency(stats.totalValue/Math.max(items.reduce((a,i)=>a+i.quantity,0),1))}/unit`}
                </div>
              </div>
            ))}
          </div>

          {/* AI PANEL */}
          <div className="ai-panel">
            <div className="ai-panel-icon">AI</div>
            <div>
              <div className="ai-panel-label">AI Inventory Insight</div>
              <div className="ai-panel-text" dangerouslySetInnerHTML={{__html: aiText}}/>
            </div>
          </div>

          {/* TOOLBAR */}
          <div className="toolbar">
            <div className="search-wrap">
              <svg width="13" height="13" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
              </svg>
              <input className="search-input" type="text" placeholder="Search by name, SKU, category, supplier..."
                value={search} onChange={e=>setSearch(e.target.value)}/>
            </div>
            <select className="filter-select" value={filterCat} onChange={e=>setFilterCat(e.target.value)}>
              <option value="all">All Categories</option>
              {CATEGORIES.map(c=><option key={c}>{c}</option>)}
            </select>
            <select className="filter-select" value={filterStatus} onChange={e=>setFilterStatus(e.target.value)}>
              <option value="all">All Statuses</option>
              {Object.entries(STATUSES).map(([k,v])=><option key={k} value={k}>{v.label}</option>)}
            </select>
          </div>

          {/* TABLE */}
          <div className="table-wrap">
            <div className="table-header-row">
              <SortTh col="name" label="Item / SKU"/>
              <SortTh col="category" label="Category"/>
              <SortTh col="quantity" label="Qty"/>
              <SortTh col="status" label="Status"/>
              <SortTh col="price" label="Price"/>
              <div className="th">Actions</div>
            </div>

            {filtered.length === 0 ? (
              <div className="empty">
                <div className="empty-icon">üì¶</div>
                <h3>No items found</h3>
                <p>Try adjusting your filters or add a new item.</p>
              </div>
            ) : filtered.map(item => (
              <div key={item.id} className="table-row" onClick={()=>openDetail(item)}>
                <div className="td">
                  <div className="td-name">{item.name}</div>
                  <div className="td-sku">{item.sku}</div>
                </div>
                <div className="td">{item.category}</div>
                <div className="td">
                  <div className="qty-wrap">
                    <span style={{color: qtyColor(item.quantity, item.maxQty), minWidth:28}}>{item.quantity}</span>
                    <div className="qty-bar-track">
                      <div className="qty-bar-fill" style={{
                        width:`${Math.min(100,Math.round(item.quantity/item.maxQty*100))}%`,
                        background: qtyColor(item.quantity, item.maxQty)
                      }}/>
                    </div>
                  </div>
                </div>
                <div className="td"><StatusBadge status={item.status}/></div>
                <div className="td">{fmtCurrency(item.price)}</div>
                <div className="td td-actions" onClick={e=>e.stopPropagation()}>
                  {can(user.role,'edit') && (
                    <button className="icon-btn" title="Edit" onClick={()=>setModal({type:'edit',item})}>‚úèÔ∏è</button>
                  )}
                  {can(user.role,'delete') && (
                    <button className="icon-btn" title="Delete" onClick={()=>{ deleteItem(item.id); }}>üóëÔ∏è</button>
                  )}
                  {!can(user.role,'edit') && (
                    <span style={{fontSize:'0.68rem',color:'var(--text3)'}}>View</span>
                  )}
                </div>
              </div>
            ))}
          </div>
        </div>
      </main>

      {/* MODAL */}
      {modal && (
        <div className="overlay" onClick={e=>e.target===e.currentTarget&&setModal(null)}>
          <div className="modal">
            {modal.type === 'create' && (
              <>
                <div className="modal-header">
                  <div className="modal-title">New Item</div>
                  <button className="modal-close" onClick={()=>setModal(null)}>‚úï</button>
                </div>
                <div className="modal-body">
                  <ItemForm onSave={saveItem} onCancel={()=>setModal(null)} role={user.role}/>
                </div>
              </>
            )}
            {modal.type === 'edit' && (
              <>
                <div className="modal-header">
                  <div className="modal-title">Edit Item</div>
                  <button className="modal-close" onClick={()=>setModal(null)}>‚úï</button>
                </div>
                <div className="modal-body">
                  <ItemForm item={modal.item} onSave={saveItem} onCancel={()=>setModal(null)} role={user.role}/>
                </div>
              </>
            )}
            {modal.type === 'detail' && (
              <ItemDetail
                item={modal.item}
                onClose={()=>setModal(null)}
                onEdit={item=>setModal({type:'edit',item})}
                onDelete={deleteItem}
                onStatusChange={changeStatus}
                role={user.role}
              />
            )}
          </div>
        </div>
      )}

      {toast && <Toast msg={toast.msg} color={toast.color} onDone={()=>setToast(null)}/>}
    </div>
  );
}

/* ‚îÄ‚îÄ ROOT ‚îÄ‚îÄ */
function App() {
  const [user, setUser] = useState(null);
  return user
    ? <Dashboard user={user} onLogout={()=>setUser(null)}/>
    : <Auth onLogin={setUser}/>;
}

ReactDOM.render(<App/>, document.getElementById('root'));
</script>
</body>
</html>
